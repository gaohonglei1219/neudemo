(function(d,c){var a=c.require;function b(e){this.width=e.width;this.height=e.height;this.mask=e.mask;this.titleText=e.titleText;this.content=e.content;this.onRender=e.onRender||function(){};this.num=Math.floor(Math.random()*1000);this.init()}b.prototype.init=function(){if(this.mask){this.createMask()}this.createBody()};b.prototype.createMask=function(){var e=Math.max(document.documentElement.scrollHeight,window.screen.height,document.body.scrollHeight);this.maskDom=d('<div class="mod-layer" id="pass-'+this.num+'"></div>');d("body").append(this.maskDom);this.maskDom.height(e)};b.prototype.show=function(){if(this.mask){this.maskDom.show()}this.domBody.show()};b.prototype.hide=function(){if(this.mask){this.maskDom.hide()}this.domBody.hide()};b.prototype.remove=function(){if(this.mask){this.maskDom.remove()}this.domBody.remove()};b.prototype.createBody=function(){this.domBody=d('<div class="mod-layer-body" id="pass-content'+this.num+'"><div class="mod-layer-body-title"><span>'+this.titleText+'</span><a id="close-'+this.num+'" href="###"></a></div><div class="mod-layer-content"><div class="mod-layer-main"></div></div></div>');d("body").append(this.domBody);this.domBody.css({width:this.width,height:this.height,marginLeft:"-"+(parseInt(this.width)/2)+"px",marginTop:"-"+(parseInt(this.height)/2)+"px"});var e=this.domBody.children(".mod-layer-content");e.height(this.height-this.domBody.children(".mod-layer-body-title").height());if(this.content){e.children(".mod-layer-main").append(this.content);this.show()}this.bind();this.onRender(this)};b.prototype.setContent=function(e){this.domBody.append(e);this.show()};b.prototype.bind=function(){var e=this;d("#close-"+this.num).on("click",function(f){e.hide();f.preventDefault()})};c.define("module/layer",b)})(baidu,window.Pass);(function(h,f){var c=f.require,b=f.require("ui/dialog/confirm"),e={},d;function g(){if(d.visible){d.hide()}}function a(){d=new b()}e.showConfirm=function(j,i){if(h.isNumber(i)){setTimeout(g,i)}if(!d){a()}if(j){d.setContent(j)}return d.show()};e.setEle=function(i){if(!d){a()}d.setTmpl(i)};f.define("module/dialog",e)})(baidu,window.Pass);(function(e,d){var b=d.require,c=b("module/dialog");var a=function(f){this.config=f};a.prototype={render:function(){this._schoolPannel=new Pass.module.layer({titleText:"选择学校",width:600,height:398,mask:true,content:'<div class="dialog_parent" id="school_pannel"></div>'});this.initSchool()},initSchool:function(g,f){var h=this;e.sio.callByServer("https://passport.baidu.com/v2/api/?ucentertownlist&type=2",function(j){if(j.errno=="110000"){var i='<div class="all_city">';e.each(j.data,function(k,l){i+='<span class="city j_city" data="'+k+'">'+l+"</span>"});i+='</div><div class="all_school j_all_school"></div>';if(!h._initSchoolFlag){h._initSchoolFlag=true;document.getElementById("school_pannel").innerHTML=i;h.initprovince("120001");e("#school_pannel").find(".j_city").each(function(){e(this).on("click",function(l){var k=e(l.target).attr("data");if(k){e("#school_pannel").find(".j_all_school").html('<img src="/static/passpc-account/img/loading_bf37cfd7.gif" /> <span>加载中，请稍后...</span>');h.initprovince(k)}})})}}})},initprovince:function(f,i){var h=this,g="https://passport.baidu.com/v2/api/?ucentereducationlist&grade=5&province="+f;e.sio.callByServer(g,function(j){if(j.errno=="110000"){var k="";if(j.data!=""){e.each(j.data,function(l,m){k+='<span class="city j_school" data="'+l+'">'+m+"</span>"})}else{k+='<span class="empty">暂时没有该地的数据</span>'}e("#school_pannel").find(".j_all_school").empty();e(k).appendTo(e("#school_pannel").find(".j_all_school"))}e("#school_pannel").find(".j_school").each(function(){e(this).on("click",function(l){var n=e(l.target).attr("data"),m=e(l.target).html();if(n){h.fire("selectSchool",{schoolCode:n,schoolName:m});h.hide()}})})})},show:function(){if(this._schoolPannel){this._schoolPannel.show()}else{this.render()}this.fire("showSchool")},hide:function(){this._schoolPannel.hide();this.fire("hideSchool")},on:function(h,g){if(!e.isFunction(g)){return this}var i,f=this._listeners_;!f&&(f=this._listeners_={});h.indexOf("on")&&(h="on"+h);!e.isArray(i=f[h])&&(i=f[h]=[]);f[h].unshift({handler:g});return this},fire:function(f,q){var h=function(i,n){this.type=i;this.returnValue=true;this.target=n||null;this.currentTarget=null;this.preventDefault=function(){this.returnValue=false}};f&&(f=new h(f));var j,g,l,o,p=this._listeners_,m=f.type,k=[f].concat(Array.prototype.slice.call(arguments,1));!p&&(p=this._listeners_={});e.extend(f,q||{});f.target=f.target||this;f.currentTarget=this;m.indexOf("on")&&(m="on"+m);e.isFunction(this[m])&&this[m].apply(this,k);(j=this._options)&&e.isFunction(j[m])&&j[m].apply(this,k);if(e.isArray(l=p[m])){for(j=l.length-1;j>-1;j--){o=l[j];o&&o.handler.apply(this,k);o&&o.once&&l.splice(j,1)}}return f.returnValue}};d.define("module/regSchool",a)})(baidu,window.Pass);(function(d,c){if(window.TPL2LOGOURL&&c.options&&(c.options.product in window.TPL2LOGOURL)){d(".mod-header a").attr({href:window.TPL2LOGOURL[c.options.product].url});d(".mod-header img").attr({src:window.TPL2LOGOURL[c.options.product].logo})}d(".mod-header a").css({display:"block"});var b=function(l){if(!c.isSchoolReg){return}var j=l;var e=function(){d(j.getElement("school")).addClass("pass-text-input-error");d(j.getElement("schoolError")).show();d(j.getElement("schoolSucc")).hide()};var i=function(){d(j.getElement("school_placeholder")).hide();d(j.getElement("school")).removeClass("pass-text-input-error");d(j.getElement("schoolError")).hide();d(j.getElement("schoolSucc")).show()};var k=function(m,n){if("placeholder" in document.createElement("input")){d(j.getElement(m)).attr({placeholder:n})}else{d(j.getElement(m+"_placeholder")).show();d(j.getElement(m+"_placeholder")).on("mousedown",function(){j.getElement(m).focus()})}};var f=new Pass.module.regSchool();f.on("selectSchool",function(n,m){j.getElement("school").value=m.schoolName;i()});var h=j.tangram_guid+"__";var g='<p id="'+h+'schoolWrapper" class="pass-form-item pass-form-item-school" style="display:block"><label for="'+h+'school" id="'+h+'schoolLabel" class="pass-label pass-label-school">学校</label><input id="'+h+'school" type="text" name="passport_college_0_school_name" class="pass-text-input pass-text-input-school" autocomplete="off"><span id="'+h+'schoolError" class="pass-item-error pass-item-error-school" style="display: none;">请选择学校</span><span id="'+h+'schoolSucc" class="pass-item-succ pass-item-succ-school" style="display: none;"></span><span id="'+h+'school_placeholder" class="pass-placeholder pass-placeholder-school" style="display: none;">请选择学校</span></p>';d(j.getElement("passwordWrapper")).after(g);d(j.getElement("school")).on("focus",function(){f.show()});d(j.getElement("school")).on("keyup",function(m){m.preventDefault()});d(j.getElement("school")).on("keydown",function(m){m.preventDefault()});d(j.getElement("form")).on("submit",function(){if(j.getElement("school").value){i()}else{e()}});k("school","请选择学校");j.on("beforeSubmit",function(m){if(!j.getElement("school").value||j.getElement("school").value==""){m.returnValue=false}})};if(baidu("#reg_content").length>0){passport.use("reg",{tangram:true},function(e){normalReg=new e.passport.reg(c.options);normalReg.on("render",function(){var f={phone:/^1[34578]\d{9}$/,email:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/};if(c.defaultAccount&&(f.phone.test(c.defaultAccount)||f.email.test(c.defaultAccount))){if(normalReg.getElement("account")){normalReg.getElement("account").value=c.defaultAccount}setTimeout(function(){normalReg.getElement("password").focus()},100)}});normalReg.render("reg_content");b(normalReg)})}if(baidu("#login_btn").length>0){var a;baidu("#login_btn").on("click",function(){if(!a){var e=["qzone","tsina","renren"],f=1;if(c.hasAuthsite=="0"){e=false;f=0}baidu.sio.callByBrowser(document.location.protocol+"//passport.baidu.com/passApi/js/uni_login_wrapper.js?cdnversion=10256259.js?cdnversion="+new Date().getTime(),function(){a=passport.pop.init({tangram:true,cache:true,loginMerge:true,staticPage:c.options.staticPage,color:c.options.color,subpro:c.options.subpro,apiOpt:{product:c.options.product,tangram:false,u:c.options.retu,qrcode:c.options.qrcode,staticPage:c.options.staticPage,sms:f},authsite:e,registerLink:c.options.registerLink});a.show()})}else{a.show()}})}setTimeout(function(){if(document.getElementById("mod_feedback")){document.getElementById("mod_feedback").href="http://passport.baidu.com/v2/?ucenterfeedback#reg"}},1000)})(baidu,window.Pass);